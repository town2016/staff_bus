webpackJsonp([3],{"1fJl":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Z7ab"),r={name:"passed",props:{tableModel:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}}}},o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"passed"},[t("iTable",{attrs:{border:"",tableModel:this.tableModel,tableData:this.tableData}})],1)},staticRenderFns:[]},i=a("VU/8")(r,o,!1,null,null,null).exports,l={name:"approval",props:{tableModel:{type:Array,default:function(){return[]}},tableData:{type:Array,default:function(){return[]}}}},s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"approval"},[t("iTable",{attrs:{border:"",tableModel:this.tableModel,tableData:this.tableData}})],1)},staticRenderFns:[]},c=a("VU/8")(l,s,!1,null,null,null).exports,p=a("Dd8w"),d=a.n(p),u=a("+aT9"),f=a.n(u),m={xlSpan:24,colSpan:24,mdSpan:24,smSpan:24},b={name:"create",data:function(){var e=this,t=this.$createElement;return{visible:!0,formData:{},formModel:[d()({elemType:"input",prop:"projectName",label:"项目名称"},m),d()({elemType:"input",prop:"constructionUnit",label:"建设单位"},m),d()({elemType:"input",prop:"address",label:"工程地点"},m,{slot:function(){return t("i",{class:"el-icon-location-outline",style:"font-size: 20px;",on:{click:e.positionHandler}})}}),d()({elemType:"render",prop:"imgList",label:"项目照片"},m,{render:function(){return t("div",[t("ul",{class:"file-wrapper"},[t("li",{on:{click:e.selectFile}},[t("el-icon",{class:"el-icon-plus"})])]),t("input",{attrs:{type:"file",id:"upload",accept:"image/png,image/jpg"},style:"display:none",on:{change:e.fileChangeHandler}})])}})],AMap:null,curLocation:{},options:[],keyWord:"",poiList:[]}},props:{},mounted:function(){var e=this;this.$nextTick(function(){e._getLocation()})},methods:{selectFile:function(){document.querySelector("#upload").click()},fileChangeHandler:function(e){console.log(e)},positionHandler:function(){var e=this;this.visible=!0,this.$nextTick(function(){e._getLocation()})},_getLocation:function(){var e=this,t=new f.a.Map("mapContainer",{zoom:14,resizeEnable:!0});this.AMap=t,t.plugin("AMap.Geolocation",function(){var a=new f.a.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new f.a.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"});a.getCurrentPosition(),f.a.event.addListener(a,"complete",function(a){var r=a.position;e.curLocation=a,e.keyWord=e.curLocation.formattedAddress,t.setCenter([r.R,r.Q]);var o=e.creatMark(r.R,r.Q);t.add(o),o.on("dragend",function(e){t.setCenter([e.lnglat.R,e.lnglat.Q]),n([e.lnglat.R,e.lnglat.Q])}),t.on("dragend",function(e){var a=t.getCenter(),r=[a.R,a.Q];setTimeout(function(){o.setPosition(r),n(r)},100)})}),f.a.event.addListener(a,"error",function(t){e.$message.error("定位失败，请检查网络，并稍后重试")});var n=function(t){(new f.a.Geocoder).getAddress(t,function(t,a){if("complete"===t&&a.regeocode){a.regeocode.formattedAddress;e.curLocation=a.regeocode,e.keyWord=e.curLocation.formattedAddress}})}})},$_close:function(){this.visible=!1},setLocation:function(){this.curLocation.formattedAddress,this.$_close(),this.$refs.iform.setFormData({address:this.curLocation.formattedAddress})},remoteMethod:function(e){var t=this;e&&f.a.service(["AMap.PlaceSearch"],function(){new f.a.PlaceSearch({pageSize:10,pageIndex:1,autoFitView:!0}).search(e,function(e,a){"complete"===e&&"OK"===a.info?(t.poiList=a.poiList.pois||[],t.poiList.forEach(function(e){var a=""+(e.pname||"")+(e.cityname||"")+(e.adname||"")+e.name+"("+(e.address||"")+")",n={label:a,value:e.id};e.formattedAddress=a,t.options.push(n)})):t.$message.error("网络繁忙，请稍后重试")})})},changeHandler:function(e){this.curLocation=this.poiList.filter(function(t){return t.id===e})[0];var t=this.curLocation.location,a=t.Q,n=t.R;this.AMap.setCenter([n,a]),this.AMap.add(this.creatMark(n,a))},creatMark:function(e,t){return new f.a.Marker({position:new f.a.LngLat(e,t),draggable:!0,cursor:"move",raiseOnDrag:!0})}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"create",staticStyle:{width:"500px"}},[a("iForm",{ref:"iform",attrs:{formModel:e.formModel,formData:e.formData}}),e._v(" "),a("el-dialog",{attrs:{width:"1000px",visible:e.visible,title:"位置选择"},on:{close:e.$_close}},[a("div",[a("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",remote:"",placeholder:"请输入关键词","remote-method":e.remoteMethod},on:{change:e.changeHandler},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("br"),a("br"),e._v(" "),a("div",{attrs:{id:"mapContainer"}})],1),e._v(" "),a("br"),e._v(" "),a("div",{attrs:{align:"center"}},[a("el-button",{attrs:{size:"medium"},on:{click:e.$_close}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"medium",type:"primary"},on:{click:e.setLocation}},[e._v("确定")])],1)])],1)},staticRenderFns:[]};var v=a("VU/8")(b,h,!1,function(e){a("GkWs")},"data-v-64577caa",null).exports,g={name:"project-approval",mixins:[{data:function(){var e=this,t=this.$createElement;return{formModelMap:{passed:[{label:"项目名称",prop:"projectName"},{label:"负责人",prop:"handler"},{label:"项目照片",prop:"banner",render:function(e,t){var a=t.row;return a.banner?e("img",{attrs:{src:a.banner,height:"30"}}):null}},{label:"建设单位",prop:"constructionUnit"},{label:"地址",prop:"address"},{label:"通过时间",prop:"createDate"},{label:"操作",render:function(){return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(){e.$router.push({path:"/project-detail"})}}},["查看"]),"passed"===e.projectStatus?t("el-button",{attrs:{type:"text"}},["删除"]):null])}}],approval:[{label:"项目名称",prop:"projectName"},{label:"负责人",prop:"handler"},{label:"项目照片",prop:"banner",render:function(e,t){var a=t.row;return a.banner?e("img",{attrs:{src:a.banner,height:"30"}}):null}},{label:"建设单位",prop:"constructionUnit"},{label:"地址",prop:"address"},{label:"通过时间",prop:"createDate"},{label:"操作",render:function(){return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(){e.$router.push({path:"/project-detail"})}}},["查看"]),"passed"===e.projectStatus?t("el-button",{attrs:{type:"text"}},["删除"]):null])}}]},formDataMap:{passed:[{banner:"https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=3216805947,683070568&fm=26&gp=0.jpg"}],approval:[],create:{}}}}}],components:{List:n.a,passed:i,approval:c,create:v},watch:{activeName:{handler:function(e){"passed"===e&&(this.attrs={tableModel:this.formModelMap[e],tableData:this.formDataMap[e]}),"approval"===e&&(this.attrs={tableModel:this.formModelMap[e],tableData:this.formDataMap[e]})},deep:!0,immediate:!0}},data:function(){return{attrs:{},activeName:"passed",tabs:[{label:"已通过",name:"passed"},{label:"审核中",name:"approval"},{label:"申请创建",name:"create"}]}}},y={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabs,function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.label,name:t.name}},[t.name===e.activeName?a(t.name,e._b({tag:"component"},"component",e.attrs,!1)):e._e()],1)}),1)],1)},staticRenderFns:[]};var M=a("VU/8")(g,y,!1,function(e){a("A+9o")},null,null);t.default=M.exports},"A+9o":function(e,t){},GkWs:function(e,t){}});
//# sourceMappingURL=3.193703caad992f9d8bed.js.map