webpackJsonp([2],{"/Lo6":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Dd8w"),o=a.n(n),r={xlSpan:24,colSpan:24,mdSpan:24,smSpan:24},i={data:function(){var e=this,t=this.$createElement;return{formModelMap:{projectInfo:[o()({elemType:"input",prop:"projectName",label:"项目名称"},r,{disabled:!0}),o()({elemType:"input",prop:"handler",label:"项目负责人"},r,{disabled:!0}),o()({elemType:"input",prop:"handlerCount",label:"项目管理员人数"},r,{disabled:!0}),o()({elemType:"input",prop:"staffCount",label:"项目总人数"},r,{disabled:!0}),o()({elemType:"input",prop:"constructionUnit",label:"建设单位"},r,{disabled:!0}),o()({elemType:"input",prop:"address"},r,{label:"地址",disabled:!0}),o()({elemType:"input",prop:"score"},r,{label:"项目评分",disabled:!0}),o()({elemType:"render",prop:"imgList"},r,{label:"项目照片",render:function(e,t){var a=t.imgList||[];return a=a.map(function(t){return e("li",[e("img",{attrs:{src:t,height:"100%"}})])}),e("ul",{class:"img-list"},[a])}}),o()({elemType:"render",prop:"handlerCount"},r,{label:" 操作",render:function(){return t("el-button",{attrs:{size:"small",type:"danger"}},["删除"])}})],projectAdmin:[{label:"姓名",prop:"name"},{label:"职位",prop:"position"},{label:"工作内容",prop:"jobContent"},{label:"操作",render:function(e,t){return e("el-button",{attrs:{type:"text"}},["删除"])}}],group:[{label:"班组名称",prop:"groupName"},{label:"班组负责人",prop:"handler"},{label:"总人数",prop:"totalCount"},{label:"操作",render:function(t,a){return t("div",[t("el-button",{attrs:{type:"text"},on:{click:function(){e.$router.push({path:"/group-detail"})}}},["查看"]),t("el-button",{attrs:{type:"text"}},["删除"])])}}],enclosure:[{elemType:"input",prop:"projectName",label:"项目名称"}]},formDataMap:{projectInfo:{imgList:["https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=3216805947,683070568&fm=26&gp=0.jpg"]},projectAdmin:[{}],group:[{}],enclosure:{}}}}},l={name:"projectInfo",props:{formModel:{type:Array,default:function(){return[]}},formData:{type:Object,default:function(){return{}}}}},s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticStyle:{width:"400px"}},[t("iForm",{attrs:{formModel:this.formModel,formData:this.formData,labelWidth:100}})],1)},staticRenderFns:[]},c=a("VU/8")(l,s,!1,null,null,null).exports,p={name:"projectAdmin",props:{tableData:{type:Array,default:function(){return[]}},tableModel:{type:Array,default:function(){return[]}}}},u={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"projectAdmin"},[t("iTable",{attrs:{tableModel:this.tableModel,tableData:this.tableData,border:""}})],1)},staticRenderFns:[]},d=a("VU/8")(p,u,!1,null,null,null).exports,m={name:"projectAdmin",props:{tableData:{type:Array,default:function(){return[]}},tableModel:{type:Array,default:function(){return[]}}}},f={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"projectAdmin"},[t("iTable",{attrs:{tableModel:this.tableModel,tableData:this.tableData,border:""}})],1)},staticRenderFns:[]},h=a("VU/8")(m,f,!1,null,null,null).exports,b=a("+aT9"),v=a.n(b),y={name:"enclosure",mounted:function(){var e=this;this.$nextTick(function(){e._getLocation()})},data:function(){return{path:[],polygon:null,polyEditor:null,keyWord:"",options:[],poiList:[],curLocation:null}},methods:{_getLocation:function(){var e=this,t=new v.a.Map("enclosure",{zoom:14,resizeEnable:!0});this.AMap=t,t.plugin("AMap.Geolocation",function(){var a=new v.a.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new v.a.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"});a.getCurrentPosition(),v.a.event.addListener(a,"complete",function(a){var n=a.position;t.setCenter([n.R,n.Q]);var o=e.creatMark(n.R,n.Q);t.add(o)}),v.a.event.addListener(a,"error",function(t){e.$message.error("定位失败，请检查网络，并稍后重试")})})},creatMark:function(e,t){return new v.a.Marker({position:new v.a.LngLat(e,t),draggable:!0,cursor:"move",raiseOnDrag:!0})},createEnclosure:function(){this.polygon=new v.a.Polygon({path:this.path,strokeColor:"#FF33FF",strokeWeight:2,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fc",zIndex:50}),this.AMap.add(this.polygon),this.AMap.setFitView([this.polygon]),this.polyEditor=new v.a.PolyEditor(this.AMap,this.polygon),this.polyEditor.open(),this.polyEditor.on("end",function(e){console.log(e)})},startEdit:function(){this.AMap.on("click",this.clickEventHandler)},clickEventHandler:function(e){this.path.push(e.lnglat),this.AMap.clearMap(),this.createEnclosure()},stopEdit:function(){this.polyEditor.close(),this.AMap.off("click",this.clickEventHandler)},deleteEnclosure:function(){this.AMap.clearMap()},remoteMethod:function(e){var t=this;e&&v.a.service(["AMap.PlaceSearch"],function(){new v.a.PlaceSearch({pageSize:10,pageIndex:1,autoFitView:!0}).search(e,function(e,a){"complete"===e&&"OK"===a.info?(t.poiList=a.poiList.pois||[],t.poiList.forEach(function(e){var a=""+(e.pname||"")+(e.cityname||"")+(e.adname||"")+e.name+"("+(e.address||"")+")",n={label:a,value:e.id};e.formattedAddress=a,t.options.push(n)})):t.$message.error("暂无搜索到结果")})})},changeHandler:function(e){this.curLocation=this.poiList.filter(function(t){return t.id===e})[0];var t=this.curLocation.location,a=t.Q,n=t.R;this.AMap.setCenter([n,a]),this.AMap.add(this.creatMark(n,a))}}},g={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"enclosure",staticStyle:{height:"100%"}},[a("div",{staticClass:"btn-group"},[a("el-select",{attrs:{filterable:"",remote:"",size:"medium",placeholder:"请输入关键词","remote-method":e.remoteMethod},on:{change:e.changeHandler},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.startEdit}},[e._v("开始编辑")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.stopEdit}},[e._v("结束编辑")]),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.deleteEnclosure}},[e._v("清除围栏")])],1),e._v(" "),a("div",{staticStyle:{width:"100%",height:"calc(100% - 80px)"},attrs:{id:"enclosure"}})])},staticRenderFns:[]};var M={name:"trackMap",data:function(){return{staffName:"",linePath:[],polyLineEditor:null}},mounted:function(){var e=this;this.$nextTick(function(){e._getLocation()})},methods:{_getLocation:function(){var e=this,t=new v.a.Map("trackMap",{zoom:14,resizeEnable:!0});this.AMap=t,t.plugin("AMap.Geolocation",function(){var a=new v.a.Geolocation({enableHighAccuracy:!0,timeout:1e4,buttonOffset:new v.a.Pixel(10,20),zoomToAccuracy:!0,buttonPosition:"RB"});a.getCurrentPosition(),v.a.event.addListener(a,"complete",function(a){var n=a.position;t.setCenter([n.R,n.Q]);var o=e.creatMark(n.R,n.Q);t.add(o)}),v.a.event.addListener(a,"error",function(t){e.$message.error("定位失败，请检查网络，并稍后重试")})})},creatMark:function(e,t){return new v.a.Marker({position:new v.a.LngLat(e,t),draggable:!0,cursor:"move",raiseOnDrag:!0})},remoteMethod:function(){},changeHandler:function(){},createLine:function(){var e=new v.a.Polyline({path:this.linePath,borderWeight:1,strokeColor:"#3366FF",strokeOpacity:1,strokeWeight:6,strokeStyle:"solid",strokeDasharray:[10,5],lineJoin:"round",lineCap:"round",zIndex:50});e.setMap(this.AMap),map.setFitView([e]),this.polyLineEditor=new v.a.PolyEditor(this.AMap,e)},closeLineEditor:function(){this.polyLineEditor.close()}}},k={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"track-wrapper"},[a("div",{staticClass:"btn-group"},[a("el-select",{attrs:{filterable:"",remote:"",size:"medium",placeholder:"请输入员工姓名/工号","remote-method":e.remoteMethod},on:{change:e.changeHandler},model:{value:e.staffName,callback:function(t){e.staffName=t},expression:"staffName"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1),e._v(" "),a("el-button",{attrs:{size:"medium"},on:{click:e.startEdit}},[e._v("查询")])],1),e._v(" "),a("div",{staticStyle:{width:"100%",height:"calc(100% - 80px)"},attrs:{id:"trackMap"}})])},staticRenderFns:[]};var A={name:"projectDetail",mixins:[i],components:{projectInfo:c,projectAdmin:d,group:h,enclosure:a("VU/8")(y,g,!1,function(e){a("zPjo")},"data-v-cb2ac550",null).exports,Track:a("VU/8")(M,k,!1,function(e){a("2HAJ")},"data-v-7e134831",null).exports},data:function(){return{activeName:"projectInfo",attrs:{},tabs:[{label:"项目信息",name:"projectInfo"},{label:"项目管理员",name:"projectAdmin"},{label:"班组",name:"group"},{label:"项目围栏",name:"enclosure"},{label:"轨迹回放",name:"Track"}]}},watch:{activeName:{handler:function(e){"projectInfo"===e&&(this.attrs={formModel:this.formModelMap[e],formData:this.formDataMap[e]}),"projectAdmin"===e&&(this.attrs={tableModel:this.formModelMap[e],tableData:this.formDataMap[e]}),"group"===e&&(this.attrs={tableModel:this.formModelMap[e],tableData:this.formDataMap[e]})},deep:!0,immediate:!0}}},E={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"projectDetail"},[a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.tabs,function(t){return a("el-tab-pane",{key:t.name,attrs:{label:t.label,name:t.name}},[e.activeName===t.name?a(t.name,e._b({tag:"component"},"component",e.attrs,!1)):e._e()],1)}),1)],1)},staticRenderFns:[]};var _=a("VU/8")(A,E,!1,function(e){a("zE3l")},null,null);t.default=_.exports},"2HAJ":function(e,t){},zE3l:function(e,t){},zPjo:function(e,t){}});
//# sourceMappingURL=2.1580cbe7c7451221ad04.js.map